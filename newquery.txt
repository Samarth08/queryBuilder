Select WU_ID.VENDOR_NBR CHAR(06) ,'|' CHAR(01)  AS | , WU_ID.VENDOR_NAME CHAR(30) ,'|' CHAR(01)  AS | , CAST('20' AS CHAR(02) || CAST(SUBSTR(ITEMDLY.WM_YR_WK,3,2) AS CHAR(02) || CAST(SUBSTR(ITEMDLY.WM_YR_WK,5,2) AS CHAR(02)  WM_YR_WK CHAR(06) ,'|' CHAR(01)  AS | , WU_ID.STATUS_CODE CHAR(01) ,'|' CHAR(01)  AS | , WU_ID.TYPE_CODE CHAR(02) ,'|' CHAR(01)  AS | , WU_ID.OLD_NBR   FORMAT 'Z(09)9' CHAR(10) ,'|' CHAR(01)  AS | , WU_ID.PRIMARY_DESC CHAR(20) ,'|' CHAR(01)  AS | , WU_ID.SIZE_DESC CHAR(06) ,'|' CHAR(01)  AS | , WU_ID.PRIMARY_DESC CHAR(20) ,'|' CHAR(01)  AS | , WU_ID.SIZE_DESC CHAR(06) ,'|' CHAR(01)  AS | , WU_ID.ACCT_DEPT_NBR   FORMAT 'Z(05)9' CHAR(06) ,'|' CHAR(01)  AS | , MDS.MDS_DESC CHAR(80) ,'|' CHAR(01)  AS | , WU_ID.ORDER_DEPT_NBR   FORMAT 'Z(05)9' CHAR(06) ,'|' CHAR(01)  AS | , SUBSTRING(WU_ID.FINELINE,1,2) CHAR(02) ,'|' CHAR(01)  AS | , ITEMDLY.EPOS_QTY CHAR(11) ,'|' CHAR(01)  AS | , ITEMDLY.EPOS_SALES   FORMAT '------------------.99' CHAR(21) ,'|' CHAR(01)  AS | , SUM(ITEMDLY.GROSS_SHIP_QTY)   FORMAT 'Z(17)9' CHAR(18) ,'|' CHAR(01)  AS | , SUM(ITEMDLY.GROSS_SHIP_QTY * ITEMDLY.GROSS_SHIP_RETAIL)   FORMAT '------------------.99' CHAR(21) ,'|' CHAR(01)  AS | , SUM(ITEMDLY.GROSS_SHIP_QTY * ITEMDLY.GROSS_SHIP_COST)   FORMAT '----------------.9999' CHAR(21) ,'|' CHAR(01)  AS | , WU_ID.ITEM_CASE_UPC CHAR(16) ,'|' CHAR(01)  AS | , WU_ID.ITM_MASTER_PK_CD CHAR(01) ,'|' CHAR(01)  AS | , SUM(ITEMDLY.ON_ORDER_QTY)   FORMAT '-Z(08)9' CHAR(10) ,'|' CHAR(01)  AS | , SUM(ITEMDLY.ON_ORDER_COST_AMT)   FORMAT '---------------.99' CHAR(18) ,'|' CHAR(01)  AS | , ITEMDLY.GREGORIAN_DATE   FORMAT 'MM/DD/YYYY' CHAR(10)  from  ( Select  CASE   when POS.ITEM_NBR IS NOT  then POS.ITEM_NBR  when SHIP.ITEM_NBR IS NOT  then SHIP.ITEM_NBR  else IWI.ITEM_NBR END AS ITEM_NBR ,  CASE   when POS.WM_YR_WK IS NOT  then POS.WM_YR_WK  when SHIP.WM_YR_WK IS NOT  then SHIP.WM_YR_WK  else WK_DAY.WM_YR_WK END AS WM_YR_WK ,  CASE   when WK_DAY.DAY_OF_WK = 1 then ZEROIFNULL(POS.SAT_QTY)  when WK_DAY.DAY_OF_WK = 2 then ZEROIFNULL(POS.SUN_QTY)  when WK_DAY.DAY_OF_WK = 3 then ZEROIFNULL(POS.MON_QTY)  when WK_DAY.DAY_OF_WK = 4 then ZEROIFNULL(POS.TUE_QTY)  when WK_DAY.DAY_OF_WK = 5 then ZEROIFNULL(POS.WED_QTY)  when WK_DAY.DAY_OF_WK = 6 then ZEROIFNULL(POS.THU_QTY)  when WK_DAY.DAY_OF_WK = 7 then ZEROIFNULL(POS.FRI_QTY) END AS EPOS_QTY ,  CASE   when WK_DAY.DAY_OF_WK = 1 then ZEROIFNULL(POS.SAT_SALES_AMT)  when WK_DAY.DAY_OF_WK = 2 then ZEROIFNULL(POS.SUN_SALES_AMT)  when WK_DAY.DAY_OF_WK = 3 then ZEROIFNULL(POS.MON_SALES_AMT)  when WK_DAY.DAY_OF_WK = 4 then ZEROIFNULL(POS.TUE_SALES_AMT)  when WK_DAY.DAY_OF_WK = 5 then ZEROIFNULL(POS.WED_SALES_AMT)  when WK_DAY.DAY_OF_WK = 6 then ZEROIFNULL(POS.THU_SALES_AMT)  when WK_DAY.DAY_OF_WK = 7 then ZEROIFNULL(POS.FRI_SALES_AMT) END AS EPOS_SALES ,  CASE   when WK_DAY.DAY_OF_WK = 1 then ZEROIFNULL(SHIP.SAT_SHIP_QTY)  when WK_DAY.DAY_OF_WK = 2 then ZEROIFNULL(SHIP.SUN_SHIP_QTY)  when WK_DAY.DAY_OF_WK = 3 then ZEROIFNULL(SHIP.MON_SHIP_QTY)  when WK_DAY.DAY_OF_WK = 4 then ZEROIFNULL(SHIP.TUE_SHIP_QTY)  when WK_DAY.DAY_OF_WK = 5 then ZEROIFNULL(SHIP.WED_SHIP_QTY)  when WK_DAY.DAY_OF_WK = 6 then ZEROIFNULL(SHIP.THU_SHIP_QTY)  when WK_DAY.DAY_OF_WK = 7 then ZEROIFNULL(SHIP.FRI_SHIP_QTY) END AS GROSS_SHIP_QTY ,  CASE   when WK_DAY.DAY_OF_WK = 1 then ZEROIFNULL(SHIP.RETAIL_AMT)  when WK_DAY.DAY_OF_WK = 2 then ZEROIFNULL(SHIP.RETAIL_AMT)  when WK_DAY.DAY_OF_WK = 3 then ZEROIFNULL(SHIP.RETAIL_AMT)  when WK_DAY.DAY_OF_WK = 4 then ZEROIFNULL(SHIP.RETAIL_AMT)  when WK_DAY.DAY_OF_WK = 5 then ZEROIFNULL(SHIP.RETAIL_AMT)  when WK_DAY.DAY_OF_WK = 6 then ZEROIFNULL(SHIP.RETAIL_AMT)  when WK_DAY.DAY_OF_WK = 7 then ZEROIFNULL(SHIP.RETAIL_AMT) END AS GROSS_SHIP_RETAIL ,  CASE   when WK_DAY.DAY_OF_WK = 1 then ZEROIFNULL(SHIP.SHIP_COST)  when WK_DAY.DAY_OF_WK = 2 then ZEROIFNULL(SHIP.SHIP_COST)  when WK_DAY.DAY_OF_WK = 3 then ZEROIFNULL(SHIP.SHIP_COST)  when WK_DAY.DAY_OF_WK = 4 then ZEROIFNULL(SHIP.SHIP_COST)  when WK_DAY.DAY_OF_WK = 5 then ZEROIFNULL(SHIP.SHIP_COST)  when WK_DAY.DAY_OF_WK = 6 then ZEROIFNULL(SHIP.SHIP_COST)  when WK_DAY.DAY_OF_WK = 7 then ZEROIFNULL(SHIP.SHIP_COST) END AS GROSS_SHIP_COST , ZEROIFNULL(IWI.ON_ORDER_QTY) AS ON_ORDER_QTY , ZEROIFNULL(IWI.ON_ORDER_COST_AMT) AS ON_ORDER_COST_AMT , WK_DAY.GREGORIAN_DATE,WK_DAY.DAY_OF_WK from GB_WM_VM.ITEM_DLY_POS AS POS ,  FULL OUTER JOIN GB_WM_VM.ITEM_DLY_SHIP AS SHIP  ON SHIP.WM_YR_WK = POS.WM_YR_WK AND SHIP.ITEM_NBR = POS.ITEM_NBR  ,  FULL OUTER JOIN GB_WM_VM.ITEM_WKLY_INV AS IWI  ON POS.WM_YR_WK = IWI.WM_YR_WK AND POS.ITEM_NBR = IWI.ITEM_NBR  ,  JOIN (Select CAL.WM_YR_WK,CAL.GREGORIAN_DATE,CAL.DAY_OF_WK from GB_WM_VM.CALENDAR_DAY AS CAL where CAL.WM_YR_WK IN ((Select DISTINCTWM_YR_WK from GB_WM_VM.CALENDAR_DAY where GREGORIAN_DATE BETWEEN (Select ADD_MONTHS(CURRENT_DATE - Extract(DAY from CURRENT_DATE) + 1,-1)) AND (Select CURRENT_DATE - Extract(DAY from CURRENT_DATE)) AND WM_YR_WK <> (Select DISTINCTMAX(WM_YR_WK) from GB_WM_VM.CALENDAR_DAY where GREGORIAN_DATE BETWEEN (Select ADD_MONTHS(CURRENT_DATE - Extract(DAY from CURRENT_DATE) + 1,-2)) AND (Select ADD_MONTHS(CURRENT_DATE - Extract(DAY from CURRENT_DATE),-1)))))) AS WK_DAY  ON POS.WM_YR_WK = WK_DAY.WM_YR_WK OR SHIP.WM_YR_WK = WK_DAY.WM_YR_WK  )  AS ITEMDLY ,  JOIN GB_WM_VM.ITEM_DESC AS WU_ID  ON ITEMDLY.ITEM_NBR = WU_ID.ITEM_NBR  ,  LEFT OUTER JOIN GB_WM_VM.MDS_DESCRIPTOR AS MDS  ON WU_ID.DEPT_DESC_ID = MDS.MDS_DESC_ID  GROUP BY 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,34,36,38,39,40,41,42,44,46,47  ORDER BY 1,5,11,47 