package BigQuery;

import org.json.JSONArray;
import org.json.JSONObject;

import java.io.FileWriter;
import java.io.IOException;
import java.nio.charset.StandardCharsets;
import java.nio.file.Files;
import java.nio.file.Paths;
import java.util.stream.Stream;


public class Bigquery {


    public String Read() throws java.io.IOException {

//        File file = new File("/Users/s0s03c5/jsontoQuery/src/main/resources/testjson.json");
        Stream<String> content = Files.lines(Paths.get("/Users/s0s03c5/jsontoQuery/src/main/resources/testjson.json"), StandardCharsets.US_ASCII);
        StringBuilder contentBuilder = new StringBuilder();

        try (Stream<String> stream = Files.lines(Paths.get("/Users/s0s03c5/jsontoQuery/src/main/resources/testjson.json"), StandardCharsets.US_ASCII)) {
            stream.forEach(s -> contentBuilder.append(s).append("\n"));
        } catch (IOException e) {
            e.printStackTrace();
        }

        return contentBuilder.toString();

    }

    public String objectParser(String s) throws IOException {

        TableBuilder tb = new TableBuilder();
//        String s="dsdf";
//        String s="{\"columnaggregate\":[],\"tables\":[{\"def\":{\"type\":\"selectentity\",\"entity\":{\"columnaggregate\":[],\"tables\":[{\"def\":{\"type\":\"selectentity\",\"entity\":{\"columnaggregate\":[],\"tables\":[{\"def\":{\"type\":\"tableentity\",\"entity\":{\"meta\":{\"schemaname\":\"WW_GEC_VM\",\"dbname\":\"wmt-edw-prod\",\"tablename\":\"INVT_INB_ON_HAND_DTL\"},\"type\":\"table\"},\"tablealias\":\"ON_HAND\"},\"type\":\"drivingtable\"},{\"FROM\":{\"type\":\"tableentity\",\"entity\":{\"meta\":{\"schemaname\":\"WW_GEC_VM\",\"dbname\":\"wmt-edw-prod\",\"tablename\":\"SHPG_NODE_RPT_CONFIG\"},\"type\":\"table\"},\"tablealias\":\"ODG\"},\"KEY\":{\"joinkey\":\"LEFT OUTER JOIN\"},\"ON\":[{\"expression\":[{\"def\":{\"colname\":\"SHIP_NODE_ORG_ID\",\"enityalias\":\"ON_HAND\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"type\":\"operand\"},{\"type\":\"operator\",\"operator\":\"=\"},{\"expression\":[{\"def\":{\"colname\":\"SHPG_NODE_ORG_ID\",\"enityalias\":\"ODG\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"type\":\"operand\"},{\"type\":\"operator\",\"operator\":\"AND\"},{\"expression\":[{\"def\":{\"colname\":\"RPT_GRP_NM\",\"enityalias\":\"ODG\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"type\":\"operand\"},{\"type\":\"operator\",\"operator\":\"=\"},{\"expression\":[{\"def\":{\"literalvalue\":\"'SC_OUTB'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"type\":\"operand\"}]},{\"FROM\":{\"type\":\"selectentity\",\"entity\":{\"columnaggregate\":[],\"tables\":[{\"def\":{\"type\":\"tableentity\",\"entity\":{\"meta\":{\"schemaname\":\"WW_GEC_VM\",\"dbname\":\"wmt-edw-prod\",\"tablename\":\"INVT_GLBL_AVLBL\"},\"type\":\"table\"},\"tablealias\":\"GLBL\"},\"type\":\"drivingtable\"},{\"FROM\":{\"type\":\"tableentity\",\"entity\":{\"meta\":{\"schemaname\":\"WW_GEC_VM\",\"dbname\":\"wmt-edw-prod\",\"tablename\":\"INVT_ITEM_LKP\"},\"type\":\"table\"},\"tablealias\":\"ITEM_LKP\"},\"KEY\":{\"joinkey\":\"LEFT JOIN\"},\"ON\":[{\"expression\":[{\"def\":{\"colname\":\"PROD_OFFR_ID\",\"enityalias\":\"GLBL\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"type\":\"operand\"},{\"type\":\"operator\",\"operator\":\"=\"},{\"expression\":[{\"def\":{\"colname\":\"SRC_ITEM_ID\",\"enityalias\":\"ITEM_LKP\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"type\":\"operand\"}]},{\"FROM\":{\"type\":\"selectentity\",\"entity\":{\"columnaggregate\":[],\"tables\":[{\"def\":{\"type\":\"tableentity\",\"entity\":{\"meta\":{\"schemaname\":\"WW_GEC_VM\",\"dbname\":\"wmt-edw-prod\",\"tablename\":\"INVT_OUTBOUND_SUMM\"},\"type\":\"table\"}},\"type\":\"drivingtable\"}],\"predicates\":[{\"expression\":[{\"def\":{\"colname\":\"TENANT_ORG_ID\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"type\":\"operand\"},{\"type\":\"operator\",\"operator\":\"=\"},{\"expression\":[{\"def\":{\"literalvalue\":\"4571\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"type\":\"operand\"},{\"type\":\"operator\",\"operator\":\"AND\"},{\"expression\":[{\"def\":{\"colname\":\"INVT_TYP_ID\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"type\":\"operand\"},{\"type\":\"operator\",\"operator\":\"=\"},{\"expression\":[{\"def\":{\"literalvalue\":\"30\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"type\":\"operand\"}],\"columns\":[{\"expression\":[{\"def\":{\"colname\":\"INVT_ITEM_KEY\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"colname\":\"TENANT_ORG_ID\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"arguments\":[[{\"def\":[{\"then\":[{\"def\":{\"colname\":\"QTY\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"when\":[{\"expression\":[{\"def\":{\"colname\":\"INVT_TYP_ID\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"type\":\"operand\"},{\"type\":\"operator\",\"operator\":\"=\"},{\"expression\":[{\"def\":{\"literalvalue\":\"30\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"type\":\"operand\"}]},{\"else\":[{\"def\":{\"literalvalue\":\"0\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]}],\"expr_type\":\"operand\",\"type\":\"case_when\"}]],\"func_name\":\"SUM\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"RESERVED_QTY\"}],\"aggregates\":[{\"func\":\"GROUP BY\",\"arguments\":[[{\"def\":{\"colname\":\"INVT_ITEM_KEY\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],[{\"def\":{\"colname\":\"TENANT_ORG_ID\"},\"expr_type\":\"operand\",\"type\":\"entity\"}]]}]},\"tablealias\":\"SUMM\"},\"KEY\":{\"joinkey\":\"LEFT JOIN\"},\"ON\":[{\"expression\":[{\"def\":{\"colname\":\"INVT_ITEM_KEY\",\"enityalias\":\"ITEM_LKP\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"type\":\"operand\"},{\"type\":\"operator\",\"operator\":\"=\"},{\"expression\":[{\"def\":{\"colname\":\"INVT_ITEM_KEY\",\"enityalias\":\"SUMM\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"type\":\"operand\"}]}],\"predicates\":[{\"expression\":[{\"def\":{\"colname\":\"CHNL\",\"enityalias\":\"GLBL\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"type\":\"operand\"},{\"type\":\"operator\",\"operator\":\"=\"},{\"expression\":[{\"def\":{\"literalvalue\":\"'S2H'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"type\":\"operand\"},{\"type\":\"operator\",\"operator\":\"AND\"},{\"expression\":[{\"def\":{\"colname\":\"LEGACY_SLR_ID\",\"enityalias\":\"GLBL\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"type\":\"operand\"},{\"type\":\"operator\",\"operator\":\"=\"},{\"expression\":[{\"def\":{\"literalvalue\":\"0\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"type\":\"operand\"}],\"columns\":[{\"expression\":[{\"def\":{\"colname\":\"CATLG_ITEM_ID\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"colname\":\"LEGACY_SLR_ID\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"arguments\":[[{\"def\":{\"colname\":\"AVLBL_STS\"},\"expr_type\":\"operand\",\"type\":\"entity\"}]],\"func_name\":\"MIN\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"AVLBL_STS\"},{\"expression\":[{\"def\":{\"arguments\":[[{\"def\":{\"colname\":\"RESERVED_QTY\"},\"expr_type\":\"operand\",\"type\":\"entity\"}]],\"func_name\":\"MIN\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"RESERVED_QTY\"}],\"aggregates\":[{\"func\":\"GROUP BY\",\"arguments\":[[{\"def\":{\"literalvalue\":\"1\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],[{\"def\":{\"literalvalue\":\"2\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]]}]},\"tablealias\":\"GLBL_AVAIL\"},\"KEY\":{\"joinkey\":\"LEFT JOIN\"},\"ON\":[{\"expression\":[{\"def\":{\"colname\":\"CATLG_ITEM_ID\",\"enityalias\":\"ON_HAND\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"type\":\"operand\"},{\"type\":\"operator\",\"operator\":\"=\"},{\"expression\":[{\"def\":{\"colname\":\"CATLG_ITEM_ID\",\"enityalias\":\"GLBL_AVAIL\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"type\":\"operand\"}]},{\"FROM\":{\"type\":\"tableentity\",\"entity\":{\"meta\":{\"schemaname\":\"WW_GEC_VM\",\"dbname\":\"wmt-edw-prod\",\"tablename\":\"INVT_INBOUND_ON_HAND\"},\"type\":\"table\"},\"tablealias\":\"IOH\"},\"KEY\":{\"joinkey\":\"LEFT OUTER JOIN\"},\"ON\":[{\"expression\":[{\"def\":{\"colname\":\"SHIP_NODE_ORG_ID\",\"enityalias\":\"IOH\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"type\":\"operand\"},{\"type\":\"operator\",\"operator\":\"=\"},{\"expression\":[{\"def\":{\"colname\":\"SHIP_NODE_ORG_ID\",\"enityalias\":\"ON_HAND\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"type\":\"operand\"},{\"type\":\"operator\",\"operator\":\"AND\"},{\"expression\":[{\"def\":{\"colname\":\"REPL_STORE_ORG_ID\",\"enityalias\":\"IOH\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"type\":\"operand\"},{\"type\":\"operator\",\"operator\":\"=\"},{\"expression\":[{\"def\":{\"colname\":\"REPL_STORE_ORG_ID\",\"enityalias\":\"ON_HAND\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"type\":\"operand\"},{\"type\":\"operator\",\"operator\":\"AND\"},{\"expression\":[{\"def\":{\"colname\":\"UPC\",\"enityalias\":\"IOH\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"type\":\"operand\"},{\"type\":\"operator\",\"operator\":\"=\"},{\"expression\":[{\"def\":{\"colname\":\"UPC\",\"enityalias\":\"ON_HAND\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"type\":\"operand\"},{\"type\":\"operator\",\"operator\":\"AND\"},{\"expression\":[{\"def\":{\"colname\":\"RPT_DT\",\"enityalias\":\"IOH\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"type\":\"operand\"},{\"type\":\"operator\",\"operator\":\"=\"},{\"expression\":[{\"def\":{\"colname\":\"RPT_DT\",\"enityalias\":\"ON_HAND\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"type\":\"operand\"}]},{\"FROM\":{\"type\":\"selectentity\",\"entity\":{\"columnaggregate\":[],\"tables\":[{\"def\":{\"type\":\"tableentity\",\"entity\":{\"meta\":{\"schemaname\":\"WW_GEC_VM\",\"dbname\":\"wmt-edw-prod\",\"tablename\":\"INVT_INB_PO_OO_RDC_QTY\"},\"type\":\"table\"}},\"type\":\"drivingtable\"}],\"predicates\":[{\"expression\":[{\"def\":{\"colname\":\"LAST_RCPT_TS\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"type\":\"operand\"},{\"type\":\"operator\",\"operator\":\"IS\"},{\"expression\":[{\"def\":{\"key\":\"NOT NULL\"},\"expr_type\":\"operand\",\"type\":\"keyword\"}],\"type\":\"operand\"}],\"columns\":[{\"expression\":[{\"def\":{\"colname\":\"END_SHIP_NODE_ORG_ID\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"colname\":\"UPC\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"arguments\":[[{\"def\":{\"colname\":\"LAST_RCPT_TS\"},\"expr_type\":\"operand\",\"type\":\"entity\"}]],\"func_name\":\"MAX\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"LAST_RCPT_TS\"}],\"aggregates\":[{\"func\":\"GROUP BY\",\"arguments\":[[{\"def\":{\"literalvalue\":\"1\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],[{\"def\":{\"literalvalue\":\"2\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]]}]},\"tablealias\":\"IPO\"},\"KEY\":{\"joinkey\":\"LEFT JOIN\"},\"ON\":[{\"expression\":[{\"def\":{\"colname\":\"END_SHIP_NODE_ORG_ID\",\"enityalias\":\"IPO\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"type\":\"operand\"},{\"type\":\"operator\",\"operator\":\"=\"},{\"expression\":[{\"def\":{\"colname\":\"SHIP_NODE_ORG_ID\",\"enityalias\":\"ON_HAND\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"type\":\"operand\"},{\"type\":\"operator\",\"operator\":\"AND\"},{\"expression\":[{\"def\":{\"colname\":\"UPC\",\"enityalias\":\"IPO\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"type\":\"operand\"},{\"type\":\"operator\",\"operator\":\"=\"},{\"expression\":[{\"def\":{\"colname\":\"UPC\",\"enityalias\":\"ON_HAND\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"type\":\"operand\"}]}],\"predicates\":[{\"expression\":[{\"def\":{\"colname\":\"RPT_DT\",\"enityalias\":\"ON_HAND\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"type\":\"operand\"},{\"type\":\"operator\",\"operator\":\"=\"},{\"expression\":[{\"def\":{\"key\":\"CURRENT_DATE\"},\"expr_type\":\"operand\",\"type\":\"keyword\"},{\"expr_type\":\"operator\",\"operator\":\"-\"},{\"def\":{\"literalvalue\":\"1\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"type\":\"operand\"}],\"columns\":[{\"expression\":[{\"def\":{\"colname\":\"SHIP_NODE\",\"enityalias\":\"ON_HAND\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"colalias\":\"FACILITY_ID\"},{\"expression\":[{\"def\":{\"colname\":\"STORE_NUM\",\"enityalias\":\"ON_HAND\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"colname\":\"PROD_KEY\",\"enityalias\":\"ON_HAND\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"colname\":\"CATLG_ITEM_ID\",\"enityalias\":\"ON_HAND\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"colalias\":\"ITEM_ID\"},{\"expression\":[{\"def\":{\"colname\":\"WM_ITEM_NUM\",\"enityalias\":\"ON_HAND\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"colname\":\"UPC\",\"enityalias\":\"ON_HAND\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"colalias\":\"UPC\"},{\"expression\":[{\"def\":{\"colname\":\"PARENT_CHILD_FLAG\",\"enityalias\":\"IOH\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"colname\":\"PROD_NM\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"colalias\":\"DESCRIPTION\"},{\"expression\":[{\"def\":{\"colname\":\"STYLE_ID_NUM\",\"enityalias\":\"ON_HAND\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"colname\":\"COLOR\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"colname\":\"SIZE\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"arguments\":[[{\"def\":{\"colname\":\"SUM_OH\"},\"expr_type\":\"operand\",\"type\":\"entity\"}]],\"func_name\":\"SUM\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"SUM_OH\"},{\"expression\":[{\"def\":{\"arguments\":[[{\"def\":{\"colname\":\"ATS\"},\"expr_type\":\"operand\",\"type\":\"entity\"}]],\"func_name\":\"SUM\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"ATS\"},{\"expression\":[{\"def\":{\"arguments\":[[{\"def\":{\"colname\":\"TRBL\"},\"expr_type\":\"operand\",\"type\":\"entity\"}]],\"func_name\":\"SUM\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"TRBL\"},{\"expression\":[{\"def\":{\"arguments\":[[{\"def\":{\"colname\":\"RIP\"},\"expr_type\":\"operand\",\"type\":\"entity\"}]],\"func_name\":\"SUM\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"RIP\"},{\"expression\":[{\"def\":{\"arguments\":[[{\"def\":{\"colname\":\"OIP\"},\"expr_type\":\"operand\",\"type\":\"entity\"}]],\"func_name\":\"SUM\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"OIP\"},{\"expression\":[{\"def\":{\"arguments\":[[{\"def\":{\"colname\":\"EIP\"},\"expr_type\":\"operand\",\"type\":\"entity\"}]],\"func_name\":\"SUM\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"EIP\"},{\"expression\":[{\"def\":{\"arguments\":[[{\"def\":{\"colname\":\"WIP\"},\"expr_type\":\"operand\",\"type\":\"entity\"}]],\"func_name\":\"SUM\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"WIP\"},{\"expression\":[{\"def\":{\"arguments\":[[{\"def\":{\"colname\":\"RTL_PRICE\"},\"expr_type\":\"operand\",\"type\":\"entity\"}]],\"func_name\":\"SUM\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"SUM_AMT_ITEM_PRICE\"},{\"expression\":[{\"def\":{\"arguments\":[[{\"def\":{\"colname\":\"RTL_PRICE\"},\"expr_type\":\"operand\",\"type\":\"entity\"}]],\"func_name\":\"AVG\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"RETAIL_PRICE\"},{\"expression\":[{\"def\":{\"arguments\":[[{\"def\":{\"colname\":\"EXT_RTL\"},\"expr_type\":\"operand\",\"type\":\"entity\"}]],\"func_name\":\"SUM\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"EXT_RETAIL\"},{\"expression\":[{\"def\":{\"arguments\":[[{\"def\":{\"colname\":\"COST\"},\"expr_type\":\"operand\",\"type\":\"entity\"}]],\"func_name\":\"SUM\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"SUM_COST\"},{\"expression\":[{\"def\":{\"arguments\":[[{\"def\":{\"colname\":\"COST\"},\"expr_type\":\"operand\",\"type\":\"entity\"}]],\"func_name\":\"AVG\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"COST\"},{\"expression\":[{\"def\":{\"arguments\":[[{\"def\":{\"colname\":\"EXT_COST\"},\"expr_type\":\"operand\",\"type\":\"entity\"}]],\"func_name\":\"SUM\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"EXT_COST\"},{\"expression\":[{\"def\":{\"arguments\":[[{\"def\":{\"colname\":\"RESERVED_QTY\"},\"expr_type\":\"operand\",\"type\":\"entity\"}]],\"func_name\":\"MIN\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"RESERVE\"},{\"expression\":[{\"def\":{\"arguments\":[[{\"def\":{\"colname\":\"RTL_PRICE\"},\"expr_type\":\"operand\",\"type\":\"entity\"}]],\"func_name\":\"AVG\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"AMT_ITEM_PRICE\"},{\"expression\":[{\"def\":{\"colname\":\"PARENT_UPC\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"colname\":\"INBOUND_ITEM_CLASS\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"colname\":\"PROD_WT\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"colalias\":\"WEIGHT\"},{\"expression\":[{\"def\":{\"colname\":\"VEND_NUM\",\"enityalias\":\"ON_HAND\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"colalias\":\"VENDOR_NUM\"},{\"expression\":[{\"def\":{\"arguments\":[[{\"def\":{\"colname\":\"SHIP_DIM_X\"},\"expr_type\":\"operand\",\"type\":\"entity\"}]],\"func_name\":\"AVG\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"SHIP_DIM_X\"},{\"expression\":[{\"def\":{\"arguments\":[[{\"def\":{\"colname\":\"SHIP_DIM_Y\"},\"expr_type\":\"operand\",\"type\":\"entity\"}]],\"func_name\":\"AVG\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"SHIP_DIM_Y\"},{\"expression\":[{\"def\":{\"arguments\":[[{\"def\":{\"colname\":\"SHIP_DIM_Z\"},\"expr_type\":\"operand\",\"type\":\"entity\"}]],\"func_name\":\"AVG\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"SHIP_DIM_Z\"},{\"expression\":[{\"def\":{\"colname\":\"DIV_NM\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"colalias\":\"DIVISION_NAME\"},{\"expression\":[{\"def\":{\"colname\":\"SUP_DEPT_NM\",\"enityalias\":\"ON_HAND\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"colalias\":\"SUPER_DEPARTMENT_NAME\"},{\"expression\":[{\"def\":{\"colname\":\"DEPT_NM\",\"enityalias\":\"ON_HAND\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"colalias\":\"DEPT\"},{\"expression\":[{\"def\":{\"colname\":\"CATEG_NM\",\"enityalias\":\"ON_HAND\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"colalias\":\"CAT\"},{\"expression\":[{\"def\":{\"colname\":\"SUB_CATEG_NM\",\"enityalias\":\"ON_HAND\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"colalias\":\"SUB_CAT\"},{\"expression\":[{\"def\":{\"arguments\":[[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"colname\":\"SHIP_DIM_X\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"38\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],[{\"def\":{\"literalvalue\":\"5\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"NUMERIC\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"},{\"expr_type\":\"operator\",\"operator\":\"*\"},{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"colname\":\"SHIP_DIM_Z\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"38\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],[{\"def\":{\"literalvalue\":\"5\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"NUMERIC\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"},{\"expr_type\":\"operator\",\"operator\":\"/\"},{\"def\":[{\"def\":{\"literalvalue\":\"12\"},\"expr_type\":\"operand\",\"type\":\"literal\"},{\"expr_type\":\"operator\",\"operator\":\"*\"},{\"def\":{\"literalvalue\":\"12\"},\"expr_type\":\"operand\",\"type\":\"literal\"},{\"expr_type\":\"operator\",\"operator\":\"*\"},{\"def\":{\"literalvalue\":\"12\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"expr_type\":\"operand\",\"type\":\"expression\"}]],\"func_name\":\"AVG\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"ITEM_CUBE\"},{\"expression\":[{\"def\":{\"colname\":\"AVLBL_STS\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"colalias\":\"AVLBL_STS\"},{\"expression\":[{\"def\":{\"arguments\":[[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"arguments\":[[{\"def\":{\"colname\":\"OFFR_END_TS\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],[{\"def\":{\"literalvalue\":\"'YYYY-MM-DD'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"TO_CHAR\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"datatype\":{\"keyword\":\"DATE\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}]],\"func_name\":\"MAX\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"END_DATE\"},{\"expression\":[{\"def\":{\"colname\":\"SHPG_NODE_GRP_NM\",\"enityalias\":\"ODG\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"arguments\":[[{\"def\":{\"colname\":\"LAST_RCPT_TS\",\"enityalias\":\"IPO\"},\"expr_type\":\"operand\",\"type\":\"entity\"}]],\"func_name\":\"MAX\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"LAST_RCPT_TS\"}],\"aggregates\":[{\"func\":\"GROUP BY\",\"arguments\":[[{\"def\":{\"colname\":\"SHIP_NODE\",\"enityalias\":\"ON_HAND\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],[{\"def\":{\"colname\":\"STORE_NUM\",\"enityalias\":\"ON_HAND\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],[{\"def\":{\"colname\":\"PROD_KEY\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],[{\"def\":{\"colname\":\"CATLG_ITEM_ID\",\"enityalias\":\"ON_HAND\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],[{\"def\":{\"colname\":\"WM_ITEM_NUM\",\"enityalias\":\"ON_HAND\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],[{\"def\":{\"colname\":\"UPC\",\"enityalias\":\"ON_HAND\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],[{\"def\":{\"colname\":\"PARENT_CHILD_FLAG\",\"enityalias\":\"IOH\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],[{\"def\":{\"colname\":\"PROD_NM\",\"enityalias\":\"ON_HAND\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],[{\"def\":{\"colname\":\"STYLE_ID_NUM\",\"enityalias\":\"ON_HAND\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],[{\"def\":{\"colname\":\"COLOR\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],[{\"def\":{\"colname\":\"SIZE\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],[{\"def\":{\"colname\":\"PARENT_UPC\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],[{\"def\":{\"colname\":\"INBOUND_ITEM_CLASS\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],[{\"def\":{\"colname\":\"PROD_WT\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],[{\"def\":{\"colname\":\"VEND_NUM\",\"enityalias\":\"ON_HAND\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],[{\"def\":{\"colname\":\"DIV_NM\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],[{\"def\":{\"colname\":\"SUP_DEPT_NM\",\"enityalias\":\"ON_HAND\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],[{\"def\":{\"colname\":\"DEPT_NM\",\"enityalias\":\"ON_HAND\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],[{\"def\":{\"colname\":\"CATEG_NM\",\"enityalias\":\"ON_HAND\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],[{\"def\":{\"colname\":\"SUB_CATEG_NM\",\"enityalias\":\"ON_HAND\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],[{\"def\":{\"colname\":\"AVLBL_STS\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],[{\"def\":{\"colname\":\"SHPG_NODE_GRP_NM\",\"enityalias\":\"ODG\"},\"expr_type\":\"operand\",\"type\":\"entity\"}]]}]},\"tablealias\":\"Y\"},\"type\":\"drivingtable\"},{\"FROM\":{\"type\":\"tableentity\",\"entity\":{\"meta\":{\"schemaname\":\"WW_GEC_VM\",\"dbname\":\"wmt-edw-prod\",\"tablename\":\"PROD_TRANSIENT_MASTER\"},\"type\":\"table\"},\"tablealias\":\"PTM\"},\"KEY\":{\"joinkey\":\"LEFT JOIN\"},\"ON\":[{\"expression\":[{\"def\":{\"colname\":\"PROD_KEY\",\"enityalias\":\"PTM\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"type\":\"operand\"},{\"type\":\"operator\",\"operator\":\"=\"},{\"expression\":[{\"def\":{\"colname\":\"PROD_KEY\",\"enityalias\":\"Y\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"type\":\"operand\"}]},{\"FROM\":{\"type\":\"tableentity\",\"entity\":{\"meta\":{\"schemaname\":\"WW_GEC_VM\",\"dbname\":\"wmt-edw-prod\",\"tablename\":\"PROD\"},\"type\":\"table\"},\"tablealias\":\"DI\"},\"KEY\":{\"joinkey\":\"LEFT OUTER JOIN\"},\"ON\":[{\"expression\":[{\"def\":{\"colname\":\"CATLG_ITEM_ID\",\"enityalias\":\"DI\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"type\":\"operand\"},{\"type\":\"operator\",\"operator\":\"=\"},{\"expression\":[{\"def\":{\"colname\":\"ITEM_ID\",\"enityalias\":\"Y\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"type\":\"operand\"},{\"type\":\"operator\",\"operator\":\"AND\"},{\"expression\":[{\"def\":{\"colname\":\"PROD_KEY\",\"enityalias\":\"DI\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"type\":\"operand\"},{\"type\":\"operator\",\"operator\":\"=\"},{\"expression\":[{\"def\":{\"colname\":\"PROD_KEY\",\"enityalias\":\"Y\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"type\":\"operand\"}]},{\"FROM\":{\"type\":\"tableentity\",\"entity\":{\"meta\":{\"schemaname\":\"WW_GEC_VM\",\"dbname\":\"wmt-edw-prod\",\"tablename\":\"PROD_LIFECYCLE_STS_TRK\"},\"type\":\"table\"},\"tablealias\":\"PDST\"},\"KEY\":{\"joinkey\":\"LEFT OUTER JOIN\"},\"ON\":[{\"expression\":[{\"def\":{\"colname\":\"CATLG_ITEM_ID\",\"enityalias\":\"PDST\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"type\":\"operand\"},{\"type\":\"operator\",\"operator\":\"=\"},{\"expression\":[{\"def\":{\"colname\":\"ITEM_ID\",\"enityalias\":\"Y\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"type\":\"operand\"}]},{\"FROM\":{\"type\":\"tableentity\",\"entity\":{\"meta\":{\"schemaname\":\"WW_GEC_VM\",\"dbname\":\"wmt-edw-prod\",\"tablename\":\"OFFR_LIFECYCLE_STS_LKP\"},\"type\":\"table\"},\"tablealias\":\"DSL\"},\"KEY\":{\"joinkey\":\"LEFT OUTER JOIN\"},\"ON\":[{\"expression\":[{\"def\":{\"colname\":\"OFFR_LIFECYCLE_STS_ID\",\"enityalias\":\"DSL\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"type\":\"operand\"},{\"type\":\"operator\",\"operator\":\"=\"},{\"expression\":[{\"def\":{\"colname\":\"PROD_LIFECYCLE_STS_ID\",\"enityalias\":\"PDST\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"type\":\"operand\"}]}],\"predicates\":[],\"columns\":[{\"expression\":[{\"def\":{\"colname\":\"FACILITY_ID\",\"enityalias\":\"Y\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"colname\":\"UPC\",\"enityalias\":\"Y\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"colalias\":\"UPC\"},{\"expression\":[{\"def\":[{\"then\":[{\"def\":{\"literalvalue\":\"'Y'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"when\":[{\"expression\":[{\"def\":{\"colname\":\"UPC\",\"enityalias\":\"Y\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"type\":\"operand\"},{\"type\":\"operator\",\"operator\":\"=\"},{\"expression\":[{\"def\":{\"colname\":\"PARENT_UPC\",\"enityalias\":\"Y\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"type\":\"operand\"}]},{\"else\":[{\"def\":{\"literalvalue\":\"'N'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]}],\"expr_type\":\"operand\",\"type\":\"case_when\"}],\"colalias\":\"IS_PARENT\"},{\"expression\":[{\"def\":{\"colname\":\"ITEM_ID\",\"enityalias\":\"Y\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"colalias\":\"ITEM_ID\"},{\"expression\":[{\"def\":{\"colname\":\"WM_ITEM_NUM\",\"enityalias\":\"Y\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"colalias\":\"WM_ITEM_NUMBER\"},{\"expression\":[{\"def\":{\"colname\":\"DESCRIPTION\",\"enityalias\":\"Y\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"colname\":\"DIVISION_NAME\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"colalias\":\"DIVISION_NAME\"},{\"expression\":[{\"def\":{\"colname\":\"SUPER_DEPARTMENT_NAME\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"colalias\":\"SUPER_DEPARTMENT_NAME\"},{\"expression\":[{\"def\":{\"colname\":\"DEPT\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"colname\":\"CAT\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"colalias\":\"CAT\"},{\"expression\":[{\"def\":{\"colname\":\"SUB_CAT\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"colname\":\"AMT_ITEM_PRICE\",\"enityalias\":\"Y\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"arguments\":[[{\"def\":{\"colname\":\"COST\"},\"expr_type\":\"operand\",\"type\":\"entity\"}]],\"func_name\":\"MAX\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"ITEM_COST\"},{\"expression\":[{\"def\":{\"arguments\":[[{\"def\":{\"colname\":\"ATS\"},\"expr_type\":\"operand\",\"type\":\"entity\"}]],\"func_name\":\"SUM\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"ATS\"},{\"expression\":[{\"def\":{\"arguments\":[[{\"def\":{\"colname\":\"TRBL\"},\"expr_type\":\"operand\",\"type\":\"entity\"}]],\"func_name\":\"SUM\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"TRBL\"},{\"expression\":[{\"def\":{\"arguments\":[[{\"def\":{\"colname\":\"RIP\"},\"expr_type\":\"operand\",\"type\":\"entity\"}]],\"func_name\":\"SUM\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"RIP\"},{\"expression\":[{\"def\":{\"arguments\":[[{\"def\":{\"colname\":\"OIP\"},\"expr_type\":\"operand\",\"type\":\"entity\"}]],\"func_name\":\"SUM\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"OIP\"},{\"expression\":[{\"def\":{\"arguments\":[[{\"def\":{\"colname\":\"EIP\"},\"expr_type\":\"operand\",\"type\":\"entity\"}]],\"func_name\":\"SUM\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"EIP\"},{\"expression\":[{\"def\":{\"arguments\":[[{\"def\":{\"colname\":\"WIP\"},\"expr_type\":\"operand\",\"type\":\"entity\"}]],\"func_name\":\"SUM\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"WIP\"},{\"expression\":[{\"def\":{\"arguments\":[[{\"def\":{\"colname\":\"SUM_OH\"},\"expr_type\":\"operand\",\"type\":\"entity\"}]],\"func_name\":\"SUM\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"SUM_OH\"},{\"expression\":[{\"def\":{\"arguments\":[[{\"def\":{\"colname\":\"EXT_COST\"},\"expr_type\":\"operand\",\"type\":\"entity\"}]],\"func_name\":\"SUM\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"EXT_COST\"},{\"expression\":[{\"def\":{\"colname\":\"STORE_NUM\",\"enityalias\":\"Y\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"arguments\":[[{\"def\":{\"colname\":\"RETAIL_PRICE\"},\"expr_type\":\"operand\",\"type\":\"entity\"}]],\"func_name\":\"SUM\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"RETAIL_PRICE\"},{\"expression\":[{\"def\":{\"arguments\":[[{\"def\":{\"colname\":\"EXT_RETAIL\"},\"expr_type\":\"operand\",\"type\":\"entity\"}]],\"func_name\":\"SUM\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"EXT_RETAIL\"},{\"expression\":[{\"def\":{\"colname\":\"VENDOR_NUM\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"arguments\":[[{\"def\":{\"colname\":\"SHIP_DIM_X\"},\"expr_type\":\"operand\",\"type\":\"entity\"}]],\"func_name\":\"AVG\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"DIM_X\"},{\"expression\":[{\"def\":{\"arguments\":[[{\"def\":{\"colname\":\"SHIP_DIM_Y\"},\"expr_type\":\"operand\",\"type\":\"entity\"}]],\"func_name\":\"AVG\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"DIM_Y\"},{\"expression\":[{\"def\":{\"arguments\":[[{\"def\":{\"colname\":\"SHIP_DIM_Z\"},\"expr_type\":\"operand\",\"type\":\"entity\"}]],\"func_name\":\"AVG\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"DIM_Z\"},{\"expression\":[{\"def\":{\"colname\":\"STYLE_ID_NUM\",\"enityalias\":\"Y\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"colname\":\"COLOR\",\"enityalias\":\"Y\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"colname\":\"SIZE\",\"enityalias\":\"Y\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"colname\":\"WEIGHT\",\"enityalias\":\"Y\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":[{\"then\":[{\"def\":{\"literalvalue\":\"'Y'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"when\":[{\"expression\":[{\"def\":{\"colname\":\"INBOUND_ITEM_CLASS\",\"enityalias\":\"Y\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"type\":\"operand\"},{\"type\":\"operator\",\"operator\":\"=\"},{\"expression\":[{\"def\":{\"literalvalue\":\"'C'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"type\":\"operand\"}]},{\"else\":[{\"def\":{\"literalvalue\":\"'N'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]}],\"expr_type\":\"operand\",\"type\":\"case_when\"}],\"colalias\":\"IS_CON\"},{\"expression\":[{\"def\":[{\"then\":[{\"def\":{\"literalvalue\":\"'Y'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"when\":[{\"expression\":[{\"def\":{\"colname\":\"S2S_IND\",\"enityalias\":\"PTM\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"type\":\"operand\"},{\"type\":\"operator\",\"operator\":\"=\"},{\"expression\":[{\"def\":{\"literalvalue\":\"1\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"type\":\"operand\"}]},{\"else\":[{\"def\":{\"literalvalue\":\"'N'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]}],\"expr_type\":\"operand\",\"type\":\"case_when\"}],\"colalias\":\"IS_S2S_ELIGIBLE\"},{\"expression\":[{\"def\":[{\"then\":[{\"def\":{\"literalvalue\":\"'Y'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"when\":[{\"expression\":[{\"def\":{\"colname\":\"S2S_ACTV_IND\",\"enityalias\":\"PTM\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"type\":\"operand\"},{\"type\":\"operator\",\"operator\":\"=\"},{\"expression\":[{\"def\":{\"literalvalue\":\"1\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"type\":\"operand\"}]},{\"else\":[{\"def\":{\"literalvalue\":\"'N'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]}],\"expr_type\":\"operand\",\"type\":\"case_when\"}],\"colalias\":\"IS_S2S_ACTIVE\"},{\"expression\":[{\"def\":[{\"then\":[{\"def\":{\"literalvalue\":\"'Y'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"when\":[{\"expression\":[{\"def\":{\"colname\":\"BACKHAUL_ELIG_IND\",\"enityalias\":\"PTM\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"type\":\"operand\"},{\"type\":\"operator\",\"operator\":\"=\"},{\"expression\":[{\"def\":{\"literalvalue\":\"1\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"type\":\"operand\"}]},{\"else\":[{\"def\":{\"literalvalue\":\"'N'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]}],\"expr_type\":\"operand\",\"type\":\"case_when\"}],\"colalias\":\"IS_BACKHAUL_ELIGIBLE\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"arguments\":[[{\"def\":{\"colname\":\"ITEM_CUBE\"},\"expr_type\":\"operand\",\"type\":\"entity\"}]],\"func_name\":\"AVG\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"38\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],[{\"def\":{\"literalvalue\":\"7\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"NUMERIC\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"ITEM_CUBE\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"arguments\":[[{\"def\":{\"colname\":\"ITEM_CUBE\"},\"expr_type\":\"operand\",\"type\":\"entity\"},{\"expr_type\":\"operator\",\"operator\":\"*\"},{\"def\":{\"colname\":\"SUM_OH\"},\"expr_type\":\"operand\",\"type\":\"entity\"}]],\"func_name\":\"AVG\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"38\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],[{\"def\":{\"literalvalue\":\"7\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"NUMERIC\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"TOTAL_CUBE\"},{\"expression\":[{\"def\":{\"colname\":\"PARENT_UPC\",\"enityalias\":\"Y\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"colname\":\"END_DATE\",\"enityalias\":\"Y\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":[{\"then\":[{\"def\":{\"literalvalue\":\"'Y'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"when\":[{\"expression\":[{\"def\":{\"colname\":\"REPLENISHABLE_IND\",\"enityalias\":\"PTM\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"type\":\"operand\"},{\"type\":\"operator\",\"operator\":\"=\"},{\"expression\":[{\"def\":{\"literalvalue\":\"1\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"type\":\"operand\"}]},{\"else\":[{\"def\":{\"literalvalue\":\"'N'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]}],\"expr_type\":\"operand\",\"type\":\"case_when\"}],\"colalias\":\"IS_REPLENISHABLE\"},{\"expression\":[{\"def\":{\"colname\":\"OFFR_LIFECYCLE_STS_DESC\",\"enityalias\":\"DSL\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"colname\":\"AVLBL_STS\",\"enityalias\":\"Y\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"colname\":\"SHPG_NODE_GRP_NM\",\"enityalias\":\"Y\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"colname\":\"LAST_RCPT_TS\",\"enityalias\":\"Y\"},\"expr_type\":\"operand\",\"type\":\"entity\"}]}],\"aggregates\":[{\"func\":\"GROUP BY\",\"arguments\":[[{\"def\":{\"colname\":\"FACILITY_ID\",\"enityalias\":\"Y\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],[{\"def\":{\"colname\":\"STORE_NUM\",\"enityalias\":\"Y\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],[{\"def\":{\"colname\":\"VENDOR_NUM\",\"enityalias\":\"Y\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],[{\"def\":{\"colname\":\"UPC\",\"enityalias\":\"Y\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],[{\"def\":{\"colname\":\"IS_PARENT\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],[{\"def\":{\"colname\":\"ITEM_ID\",\"enityalias\":\"Y\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],[{\"def\":{\"colname\":\"WM_ITEM_NUM\",\"enityalias\":\"Y\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],[{\"def\":{\"colname\":\"PARENT_UPC\",\"enityalias\":\"Y\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],[{\"def\":{\"colname\":\"DESCRIPTION\",\"enityalias\":\"Y\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],[{\"def\":{\"colname\":\"STYLE_ID_NUM\",\"enityalias\":\"Y\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],[{\"def\":{\"colname\":\"COLOR\",\"enityalias\":\"Y\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],[{\"def\":{\"colname\":\"SIZE\",\"enityalias\":\"Y\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],[{\"def\":{\"colname\":\"DIVISION_NAME\",\"enityalias\":\"Y\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],[{\"def\":{\"colname\":\"SUPER_DEPARTMENT_NAME\",\"enityalias\":\"Y\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],[{\"def\":{\"colname\":\"DEPT\",\"enityalias\":\"Y\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],[{\"def\":{\"colname\":\"CAT\",\"enityalias\":\"Y\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],[{\"def\":{\"colname\":\"SUB_CAT\",\"enityalias\":\"Y\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],[{\"def\":{\"colname\":\"AMT_ITEM_PRICE\",\"enityalias\":\"Y\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],[{\"def\":{\"colname\":\"INBOUND_ITEM_CLASS\",\"enityalias\":\"Y\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],[{\"def\":{\"colname\":\"WEIGHT\",\"enityalias\":\"Y\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],[{\"def\":{\"colname\":\"S2S_IND\",\"enityalias\":\"PTM\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],[{\"def\":{\"colname\":\"S2S_ACTV_IND\",\"enityalias\":\"PTM\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],[{\"def\":{\"colname\":\"BACKHAUL_ELIG_IND\",\"enityalias\":\"PTM\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],[{\"def\":{\"colname\":\"END_DATE\",\"enityalias\":\"Y\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],[{\"def\":{\"colname\":\"REPLENISHABLE_IND\",\"enityalias\":\"PTM\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],[{\"def\":{\"colname\":\"OFFR_LIFECYCLE_STS_DESC\",\"enityalias\":\"DSL\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],[{\"def\":{\"colname\":\"AVLBL_STS\",\"enityalias\":\"Y\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],[{\"def\":{\"colname\":\"SHPG_NODE_GRP_NM\",\"enityalias\":\"Y\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],[{\"def\":{\"colname\":\"LAST_RCPT_TS\",\"enityalias\":\"Y\"},\"expr_type\":\"operand\",\"type\":\"entity\"}]]}]},\"tablealias\":\"Y1\"},\"type\":\"drivingtable\"}],\"predicates\":[],\"columns\":[{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"literalvalue\":\"'WALMART'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"20\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"TENANT\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"literalvalue\":\"'|'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"01\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"colname\":\"FACILITY_ID\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"40\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"FACILITY\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"literalvalue\":\"'|'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"01\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"colname\":\"UPC\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"40\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"UPC\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"literalvalue\":\"'|'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"01\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"colname\":\"IS_PARENT\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"01\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"IS_PARENT\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"literalvalue\":\"'|'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"01\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"colname\":\"ITEM_ID\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"11\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"},\"format\":\"'-Z(9)9'\"}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"ITEM_ID\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"literalvalue\":\"'|'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"01\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"colname\":\"WM_ITEM_NUMBER\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"100\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"WM_ITEM_NUMBER\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"literalvalue\":\"'|'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"01\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"colname\":\"DESCRIPTION\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"500\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"DESCRIPTION\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"literalvalue\":\"'|'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"01\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"colname\":\"DIVISION_NAME\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"50\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"DIVISION_NAME\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"literalvalue\":\"'|'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"01\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"colname\":\"SUPER_DEPARTMENT_NAME\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"50\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"SUPER_DEPARTMENT_NAME\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"literalvalue\":\"'|'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"01\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"colname\":\"DEPT\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"50\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"DEPT\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"literalvalue\":\"'|'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"01\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"colname\":\"CAT\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"50\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"CAT\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"literalvalue\":\"'|'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"01\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"arguments\":[[{\"def\":{\"colname\":\"SUB_CAT\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],[{\"def\":{\"literalvalue\":\"0\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],[{\"def\":{\"literalvalue\":\"50\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"SUBSTR\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"50\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"SUB_CAT\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"literalvalue\":\"'|$'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"02\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"colname\":\"AMT_ITEM_PRICE\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"23\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"},\"format\":\"'-ZZ,ZZZ,ZZZ,ZZ9.9999999'\"}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"CURRENT_RETAIL\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"literalvalue\":\"'|$'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"02\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"colname\":\"ITEM_COST\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"23\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"},\"format\":\"'-ZZ,ZZZ,ZZZ,ZZ9.9999999'\"}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"ITEM_COST\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"literalvalue\":\"'|'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"01\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"colname\":\"ATS\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"24\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"},\"format\":\"'-ZZ,ZZZ,ZZZ,ZZZ,ZZ9.9999'\"}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"ATS\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"literalvalue\":\"'|'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"01\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"colname\":\"TRBL\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"24\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"},\"format\":\"'-ZZ,ZZZ,ZZZ,ZZZ,ZZ9.9999'\"}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"TRBL\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"literalvalue\":\"'|'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"01\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"colname\":\"RIP\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"24\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"},\"format\":\"'-ZZ,ZZZ,ZZZ,ZZZ,ZZ9.9999'\"}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"RIP\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"literalvalue\":\"'|'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"01\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"colname\":\"OIP\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"24\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"},\"format\":\"'-ZZ,ZZZ,ZZZ,ZZZ,ZZ9.9999'\"}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"OIP\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"literalvalue\":\"'|'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"01\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"colname\":\"EIP\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"24\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"},\"format\":\"'-ZZ,ZZZ,ZZZ,ZZZ,ZZ9.9999'\"}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"EIP\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"literalvalue\":\"'|'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"01\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"colname\":\"WIP\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"24\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"},\"format\":\"'-ZZ,ZZZ,ZZZ,ZZZ,ZZ9.9999'\"}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"WIP\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"literalvalue\":\"'|'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"01\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"colname\":\"SUM_OH\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"24\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"},\"format\":\"'-ZZ,ZZZ,ZZZ,ZZZ,ZZ9.9999'\"}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"SUM_OH\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"literalvalue\":\"'|$'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"02\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"colname\":\"EXT_COST\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"23\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"},\"format\":\"'-ZZ,ZZZ,ZZZ,ZZ9.9999999'\"}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"EXT_COST\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"literalvalue\":\"'|'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"01\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"colname\":\"STORE_NUM\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"40\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"STORE_NUMBER\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"literalvalue\":\"'|$'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"02\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"colname\":\"RETAIL_PRICE\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"23\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"},\"format\":\"'-ZZ,ZZZ,ZZZ,ZZ9.9999999'\"}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"RETAIL_PRICE\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"literalvalue\":\"'|$'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"02\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"colname\":\"EXT_RETAIL\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"23\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"},\"format\":\"'-ZZ,ZZZ,ZZZ,ZZ9.9999999'\"}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"EXT_RETAIL\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"literalvalue\":\"'|'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"01\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"colname\":\"VENDOR_NUM\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"50\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"VENDOR_NUMBER\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"literalvalue\":\"'|'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"01\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"colname\":\"DIM_X\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"23\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"},\"format\":\"'-ZZ,ZZZ,ZZZ,ZZ9.9999999'\"}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"DIM_X\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"literalvalue\":\"'|'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"01\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"colname\":\"DIM_Y\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"23\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"},\"format\":\"'-ZZ,ZZZ,ZZZ,ZZ9.9999999'\"}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"DIM_Y\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"literalvalue\":\"'|'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"01\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"colname\":\"DIM_Z\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"23\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"},\"format\":\"'-ZZ,ZZZ,ZZZ,ZZ9.9999999'\"}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"DIM_Z\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"literalvalue\":\"'|'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"01\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"colname\":\"STYLE_ID_NUM\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"50\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"STYLE_ID_NUM\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"literalvalue\":\"'|'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"01\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"colname\":\"COLOR\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"500\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"COLOR\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"literalvalue\":\"'|'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"01\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"colname\":\"SIZE\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"500\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"SIZE\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"literalvalue\":\"'|'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"01\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"colname\":\"WEIGHT\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"23\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"},\"format\":\"'-ZZ,ZZZ,ZZZ,ZZ9.9999999'\"}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"WEIGHT\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"literalvalue\":\"'|'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"01\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"literalvalue\":\"''\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"01\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"BUNDLE_ID\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"literalvalue\":\"'|'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"01\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"colname\":\"IS_CON\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"01\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"IS_CON\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"literalvalue\":\"'|'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"01\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"colname\":\"IS_S2S_ELIGIBLE\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"01\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"IS_S2S_ELIGIBLE\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"literalvalue\":\"'|'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"01\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"colname\":\"IS_S2S_ACTIVE\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"01\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"IS_S2S_ACTIVE\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"literalvalue\":\"'|'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"01\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"colname\":\"IS_BACKHAUL_ELIGIBLE\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"01\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"IS_BACKHAUL_ELIGIBLE\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"literalvalue\":\"'|'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"01\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"colname\":\"ITEM_CUBE\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"23\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"},\"format\":\"'-ZZ,ZZZ,ZZZ,ZZ9.9999999'\"}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"ITEM_CUBE\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"literalvalue\":\"'|'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"01\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"colname\":\"TOTAL_CUBE\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"23\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"},\"format\":\"'-ZZ,ZZZ,ZZZ,ZZ9.9999999'\"}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"TOTAL_CUBE\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"literalvalue\":\"'|'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"01\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"colname\":\"PARENT_UPC\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"40\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"PARENT_UPC\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"literalvalue\":\"'|'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"01\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"arguments\":[[{\"def\":{\"colname\":\"END_DATE\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],[{\"def\":{\"literalvalue\":\"'MM/DD/YYYY'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"TO_CHAR\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"10\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"END_DATE\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"literalvalue\":\"'|'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"01\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"colname\":\"IS_REPLENISHABLE\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"01\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"IS_REPLENISHABLE\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"literalvalue\":\"'|'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"01\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"arguments\":[[{\"def\":{\"colname\":\"OFFR_LIFECYCLE_STS_DESC\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],[{\"def\":{\"literalvalue\":\"0\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],[{\"def\":{\"literalvalue\":\"1\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"SUBSTR\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"01\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"DISPLAY_STATUS_DESC\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"literalvalue\":\"'|'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"01\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"arguments\":[[{\"def\":{\"colname\":\"AVLBL_STS\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],[{\"def\":{\"literalvalue\":\"0\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],[{\"def\":{\"literalvalue\":\"1\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"SUBSTR\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"01\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"AVAILABILITY_STATUS_DESC\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"literalvalue\":\"'|'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"01\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"colname\":\"SHPG_NODE_GRP_NM\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"40\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"DSTRBTR_GRP_NM\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"literalvalue\":\"'|'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"01\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"colname\":\"LAST_RCPT_TS\"},\"expr_type\":\"operand\",\"type\":\"entity\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"26\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"},\"format\":\"'YYYY-MM-DDBHH.MI.S(6)'\"}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}],\"colalias\":\"LAST_RCPT_TS\"},{\"expression\":[{\"def\":{\"arguments\":[{\"expression\":[{\"def\":{\"literalvalue\":\"'|'\"},\"expr_type\":\"operand\",\"type\":\"literal\"}],\"datatype\":{\"arguments\":[[{\"def\":{\"literalvalue\":\"01\"},\"expr_type\":\"operand\",\"type\":\"literal\"}]],\"func_name\":\"CHAR\"}}],\"func_name\":\"CAST\"},\"expr_type\":\"operand\",\"type\":\"function\"}]}],\"aggregates\":[]}";
        String query = "Select ";

        String stoadd = "";
        String resulTQuery = "";

        JSONArray jsonArray1 = new JSONArray(s);
        JSONObject jsonObject=jsonArray1.getJSONObject(0).getJSONObject("selectionobject");
        JSONArray jsonArrayColumns;

        if(jsonObject.getJSONArray("columnaggregate").length()>0)
        {
            for(int i=0;i<jsonObject.getJSONArray("columnaggregate").length();i++)
            {
                query=query+jsonObject.getJSONArray("columnaggregate").getJSONObject(0).get("aggproj");
            }

        }
        jsonArrayColumns = jsonObject.getJSONArray("columns");



        ExpressionBuilder eb = new ExpressionBuilder();
        FunctionImpl function = new FunctionImpl();
        EntityImpl entity = new EntityImpl();
        LiteralImpl literal = new LiteralImpl();
        for (int i = 0; i < jsonArrayColumns.length(); i++) {
            String colalias = "";
            JSONArray expression = jsonArrayColumns.getJSONObject(i).getJSONArray("expression");
            try {
                colalias = jsonArrayColumns.getJSONObject(i).get("colalias").toString();
            } catch (Exception e) {
                colalias = "";
            }
            String express = "";

            express = express + eb.Expression(expression);
            if (colalias.equals("")) {
                if (i == jsonArrayColumns.length() - 1) {
                    resulTQuery = resulTQuery + express;
                } else {
                    resulTQuery = resulTQuery + express + ",";
                }
            } else {
                if (i == jsonArrayColumns.length() - 1) {
                    resulTQuery = resulTQuery + express + " AS " + colalias;
                } else {
                    resulTQuery = resulTQuery + express + " AS " + colalias + " , ";
                }
            }
        }
        String from="";
        JSONArray tableArray = jsonObject.getJSONArray("tables");
        if(tableArray.length()>0)
            from = " from ";

        for (int i = 0; i < tableArray.length(); i++) {

                if(i==tableArray.length()-1)
                {
                    from = from + tb.TableBuilder(tableArray.getJSONObject(i));
                }
                else {

                    from = from + tb.TableBuilder(tableArray.getJSONObject(i)) + " " + "," + " ";
                }



        }
        JSONArray predicates = jsonObject.getJSONArray("predicates");
        String where = " where ";
        String pred = "";
        int flag=0;
//        for (int i = 0; i < predicates.length(); i++) {
//            String express = "";
//            String colalias = "";
//            if (predicates.getJSONObject(i).has("expr_type")&&predicates.getJSONObject(i).getString("expr_type").equals("operator")) {
//
//                if(predicates.getJSONObject(i).getString("operator").equals("BETWEEN")) {
//                flag=1;
//                }
//                else
//                {
//                    pred = pred + " " + predicates.getJSONObject(i).getString("operator");
//                }
//            }
//            else if(predicates.getJSONObject(i).has("nestedcondtnobj"))
//            {
//                JSONArray nestedarray=predicates.getJSONObject(i).getJSONArray("nestedcondtnobj");
//                express=express+ "(";
//                String temp="";
//                for(int j=0;j<nestedarray.length();j++)
//                {
//                    if (nestedarray.getJSONObject(j).has("expr_type")&&nestedarray.getJSONObject(j).getString("expr_type").equals("operator"))
//                    {
//                        express = express + " "+nestedarray.getJSONObject(j).getString("operator");
//                        if(nestedarray.getJSONObject(j).getString("operator").equals("BETWEEN")) {
//                            flag=1;
//                        }
//                        else
//                        {
//                            temp = temp + " " + nestedarray.getJSONObject(j).getString("operator");
//                        }
//
//                    }
//                    else {
//                        System.out.println(flag);
//                        if(flag==1) {
//                            JSONObject operand1=nestedarray.getJSONObject(j).getJSONObject("operand1");
//                            JSONObject operand2=nestedarray.getJSONObject(j).getJSONObject("operand2");
//                            String op1=eb.Expression(operand1.getJSONArray("expression"));
//                            String op2=eb.Expression(operand2.getJSONArray("expression"));
//                            flag=0;
//                            System.out.println("operand1"+op1);
//                            temp=temp+op1 +" BETWEEN " + op2;
//                        }
//                        else
//                        {
//                            System.out.println("fsdfdsf");
//                            temp = temp + eb.Expression(nestedarray.getJSONObject(j).getJSONArray("expression"));
//                            System.out.println(temp);
//                        }
//                    }
//                }
//                express=express+temp;
//                express=express+")";
//                pred=pred+express;
//            }
//            else {
//                if (predicates.getJSONObject(i).has("type") && predicates.getJSONObject(i).getString("type").equals("selectentity")) {
//                    Bigquery bq = new Bigquery();
////                String s=tableObject.getJSONObject("FROM");
////                System.out.println(tableObject.getJSONObject("def").getJSONObject("entity").toString());
//                    JSONArray predExpression=predicates.getJSONObject(i).getJSONArray("expression");
//                    pred = pred + " ( " + bq.objectParser(predicates.getJSONObject(i).getJSONArray("expression").toString()) + " ) ";
//                } else {
//                    JSONArray expression = predicates.getJSONObject(i).getJSONArray("expression");
//                    try {
//                        colalias = jsonArrayColumns.getJSONObject(i).get("colalias").toString();
//                    } catch (Exception e) {
//                        colalias = "";
//                    }
//                    express = express + eb.Expression(expression);
//                    pred = pred + " " + express;
//                }
//            }
//            System.out.println(pred);
//        }
        Predicatebulider keywordsHandler = new Predicatebulider();
        pred=keywordsHandler.handlePred(predicates);
        if(pred.equals(""))
        {
            where="";
        }
        else {
            where = where + pred;
        }
        JSONArray groupAgregates = jsonObject.getJSONArray("aggregates");
        String groupAggregate="";
        Aggregate agg= new Aggregate();
        for(int i=0;i<groupAgregates.length();i++)
        {
            String args =agg.buildAggregate(jsonObject.getJSONArray("aggregates").getJSONObject(i).getJSONArray("arguments"));
            String func=jsonObject.getJSONArray("aggregates").getJSONObject(i).getString("func");
            groupAggregate=groupAggregate+" "+func+" "+args+" ";
        }
        return query + resulTQuery+from+where+groupAggregate;
    }

    public static void main(String args[]) throws IOException {

        Bigquery bigquery = new Bigquery();
        String s = bigquery.Read();
        FileWriter fw =new FileWriter("newquery.txt");
        fw.write(bigquery.objectParser(s));
        fw.close();
        System.out.println(bigquery.objectParser(s));
    }
}
